<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.2">
<!-- Support/CacheManager/listItemsByPage
-
- INPUT
-
- OUTPUT
-
-->
<CALLELEMENT NAME="Support/general"/>
<div id="content">
<CALLELEMENT NAME="Support/Topnav"/>
<Script Language="Javascript">
function gotoPreview(F, dict)
{
    <PROPERTY.GET INIFILE="futuretense_xcel.ini" PARAM="xcelerate.previewhost" VARNAME="preview-host"/>
    <PROPERTY.GET INIFILE="futuretense_xcel.ini" PARAM="xcelerate.previewservlet" VARNAME="preview-servlet"/>
    var pURL = "<ics.resolvevariables NAME="$(Variables.preview-host)$(CS.Property.ft.approot)$(Variables.preview-servlet)" delimited="true"/>";
    pURL = pURL + "?pagename=";
     
    i = 0;
    <![CDATA[
    while (i < dict.options.length) {
        if (dict.options[i].selected) {
            var value = dict.options[i].value;

            if (value == "None") return;

            pURL = pURL + dict.options[i].value;
            break;
        }
        i++;
    }
    ]]>
showPreview(pURL);
}

function openPreview(id)
{
    var pURL = "<ics.resolvevariables NAME="$(Variables.preview-host)$(CS.Property.ft.approot)ContentServer" delimited="true"/>";
    pURL = pURL + "?pagename=";
   	pURL = pURL + "Support/CacheManager/ShowCachedPage&#38;pid=" + id;
     
    PreviewWindow = window.open(pURL, "NewPreviewContent", "width=700,height=480,scrollbars=yes,toolbar=no,location=no,status=yes,menubar=no,resizable=yes,directories=no");
    PreviewWindow.focus();
}	

function showPreview(pURL)
{
    PreviewWindow = window.open(pURL, "PreviewContent", "width=640,height=480,scrollbars=yes,toolbar=yes,location=yes,status=yes,menubar=yes,resizable=yes,directories=yes");
    PreviewWindow.focus();
}	
</Script>

<h3>List Assets per Cached Pagelet</h3>
<IF COND="IsVariable.pid=false"><THEN>
<b>No pid found to list</b><br/>
</THEN><ELSE>
	<SETVAR NAME="tablename" VALUE="SystemPageCache"/>
	<EXECSQL  SQL="SELECT * FROM SystemPageCache WHERE id = Variables.pid" LIST="page" table="SystemPageCache" />
	<IF COND="Variables.errno=-101"><THEN>Page not found! (Maybe not in cache anymore?)<br/>
	</THEN><ELSE>
	<p><CSVAR NAME="page.@urlqry"/></p>
		<table class="altClass">
			<tr>
				<th>ModTime</th>
				<th>ExpiryTime</th>
				<th>Display</th>
			</tr>
			<tr>
				<td><CSVAR NAME="page.mtime"/></td>
				<td><CSVAR NAME="page.etime"/></td>
				<td><a HREF="javascript:void(0)" onclick="openPreview('page.id');" onmouseover="window.status='show cached page';return true;" onmouseout="window.status='';return true" REPLACEALL="page.id">show cached pagelet</a></td>
			</tr>
			<tr><td colspan="3"><CSVAR NAME="page.@urlhead"/></td></tr>
		</table>
		<br/>
		<CALLELEMENT NAME="Support/CacheManager/listAssetDetails"/>		
		<br/>
		<CALLELEMENT NAME="Support/CacheManager/listPageMarkers">
			<ARGUMENT NAME="pagebody" VALUE="page.@urlpage"/>
		</CALLELEMENT>		
	</ELSE></IF>
</ELSE></IF>
<CALLELEMENT NAME="Support/Footer"/>
</div>
</FTCS>
